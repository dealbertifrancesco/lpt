% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calibrate_B.R
\name{calibrate_B}
\alias{calibrate_B}
\title{Calibrate the sensitivity parameter B from pre-treatment periods}
\usage{
calibrate_B(
  data,
  id_col,
  time_col,
  outcome_col,
  dose_col,
  pre_periods,
  eval_points = NULL,
  k = 20,
  spline_bs = "cr"
)
}
\arguments{
\item{data}{Data frame in long format.}

\item{id_col}{Character. Unit identifier column.}

\item{time_col}{Character. Time period column.}

\item{outcome_col}{Character. Outcome column.}

\item{dose_col}{Character. Dose column.}

\item{pre_periods}{Vector. Pre-treatment period identifiers (in order).
Must have at least 2 elements.}

\item{eval_points}{Numeric vector or NULL. Dose grid for evaluation.}

\item{k}{Integer. Spline basis dimension. Default: 20.}

\item{spline_bs}{Character. Spline basis type. Default: \code{"cr"}.}
}
\value{
A list with components:
  \describe{
    \item{B_hat}{Numeric. Calibrated sensitivity parameter
      \eqn{\hat{B} = \max_s \sup_d |\hat{\mu}'_s(d)|}.}
    \item{pre_slopes}{Data frame with columns \code{period_pair},
      \code{d}, \code{mu_prime_d}, \code{se}.}
    \item{sup_by_period}{Named numeric vector of
      \eqn{\sup_d |\hat{\mu}'_s(d)|} for each pre-period pair.}
  }
}
\description{
Estimates the sensitivity parameter B (a Lipschitz bound on the selection
slope) by computing dose-response slopes in each consecutive pre-period pair
and taking the maximum supremum. In pre-periods there is no treatment effect,
so \eqn{\lambda(d) = \mu'(d)} directly measures the selection slope.
}
\examples{
data(sru)
cal <- calibrate_B(sru, "commune", "year", "outcome", "dose",
                    pre_periods = 1993:1999)
cal$B_hat

}
